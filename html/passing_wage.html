<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Manager Tools</title>
    <link href="style2.css" rel="stylesheet" >
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Tangerine">
    <title>Scatter Plot with D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .tooltip {
            position: absolute;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ccc;
            pointer-events: none;
            opacity: 0;
        }
    </style>
</head>
<body>
    <h1 style="text-align: center;">Players' Passing vs. Wage (EUR)</h1>
    <svg id="scatterplot" width="800" height="600"></svg>

    <!-- Tooltip element -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // Load the CSV data
        d3.csv("filtered_male_players.csv").then(function(data) {
            // Filter out rows where 'passing' is less than 20
            data = data.filter(function(d) {
                return +d.passing >= 20;
            });

            // Convert data types if necessary
            data.forEach(function(d) {
                d.passing = +d.passing; 
                d.wage_eur = +d.wage_eur; 
            });

            // Set up margins and dimensions for the plot
            const margin = { top: 50, right: 50, bottom: 50, left: 90 };
            const width = 800 - margin.left - margin.right;
            const height = 600 - margin.top - margin.bottom;

            // Append SVG to the container
            const svg = d3.select("#scatterplot")
                          .attr("width", width + margin.left + margin.right)
                          .attr("height", height + margin.top + margin.bottom)
                          .append("g")
                          .attr("transform", `translate(${margin.left},${margin.top})`);

            // Define scales for x and y axes based on filtered data
            const xScale = d3.scaleLinear()
                            .domain(d3.extent(data, d => d.passing))
                            .range([0, width]);

            const yScale = d3.scaleLinear()
                            .domain(d3.extent(data, d => d.wage_eur))
                            .range([height, 0]);

            // Create circles for the scatter plot
            svg.selectAll("circle")
               .data(data)
               .enter()
               .append("circle")
               .attr("cx", d => xScale(d.passing))
               .attr("cy", d => yScale(d.wage_eur))
               .attr("r", 3) 
               .style("fill", "steelblue")
               .on("mouseover", function(event, d) {
                   // Show tooltip on mouseover
                   const tooltip = d3.select("#tooltip");
                   tooltip.transition().duration(200).style("opacity", 0.9);
                   tooltip.html(`<strong>${d.long_name}</strong><br>Passing: ${d.passing}<br>Wage: ${d.wage_eur} EUR`)
                          .style("left", (event.pageX + 10) + "px")
                          .style("top", (event.pageY - 28) + "px");
               })
               .on("mousemove", function(event) {
                   // Update tooltip position on mousemove
                   d3.select("#tooltip")
                     .style("left", (event.pageX + 10) + "px")
                     .style("top", (event.pageY - 28) + "px");
               })
               .on("mouseleave", function() {
                   // Hide tooltip on mouseleave
                   d3.select("#tooltip").transition().duration(500).style("opacity", 0);
               });

            // Add x-axis
            svg.append("g")
               .attr("transform", `translate(0,${height})`)
               .call(d3.axisBottom(xScale));

            // Add y-axis
            svg.append("g")
               .call(d3.axisLeft(yScale));

            // Add labels
            svg.append("text")
               .attr("transform", `translate(${width / 2},${height + margin.top - 10})`)
               .style("text-anchor", "middle")
               .text("Passing");

            svg.append("text")
               .attr("transform", "rotate(-90)")
               .attr("y", 0 - margin.left)
               .attr("x", 0 - (height / 2))
               .attr("dy", "1em")
               .style("text-anchor", "middle")
               .text("Wage (EUR)");
        }).catch(function(error) {
            console.log("Error loading data:", error);
        });
    </script>
    <h4 id="caption">Hover over each point for more information</h4>
    <h3><strong> Findings & Conclusion</strong></h3>
    <p>Scatter plot that shows wage trend for a specific player attribute.
        This scatter plot can help managers determine what players to sign based
        on passing ability which is very important skill because better passing players will
        create better goal scoring opportunities, and more goals will likely contribute to more
        value for a team. A manager can use this plot by viewing what players may be within their
        budget and compare players who have the passing ability their team needs.<p>
</body>
</html>